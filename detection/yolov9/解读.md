# YOLOv9: Learning What You Want to Learn Using Programmable Gradient Information

## 提出问题

1. 现有的方法忽略了输入图像在经过特征提取等操作后特征丢失的问题

## 创新点

1. 分析了现有的方法特征丢失的问题，并提出了PGI解决这一问题。
2. 设计的PGI解决了深度监督只能用在深层的网络结构当中。
3. 提出了GELAN，它只使用了传统卷积，但是有更高的参数使用率，并且具有轻量、快速、准确的巨大优势。
4. 结合PGI和GELAN提出了YOLOv9

## 信息瓶颈原理

当输入经过变换函数后，信息会丢失，如公式所示。
$$
I(X,X) \geq I(X,f_\theta(X)) \geq I(X,g_\phi(f_\theta(X)))
$$
这表示了网络越深，原始信息越可能丢失。然而，深度神经网络的参数是基于网络输出以及给定目标，然后通过计算损失函数生成新的梯度更新网络。可以想象，深层神经网络的输出能力较低，无法完整地保留有关预测目标的信息。这将导致在网络训练过程中使用不完整信息，导致不可靠的梯度和收敛困难。

## 可逆函数

当一个函数 r 具有反向转换函数 v 时，我们称这个函数为可逆函数
$$
X=v_\zeta(r_\psi(X))
$$
数据通过可逆函数不会损失信息
$$
I(X,X) = I(X,r_\zeta(X)) = I(X,v_\psi(r_\zeta(X)))
$$
虽然现有的网络很多都符合可逆函数的特征，但是对于困难的问题，难以找到简单的映射函数将数据映射到目标。

本文目标：提出一种新的深度神经网络训练方法，既能生成可靠的梯度来更新模型，又能适用于浅层和轻量级神经网络

## 可编程梯度信息

PGI的组件：
1、主分支
2、辅助可逆分支
3、多级辅助信息

PGI在推理时只会使用主分支进行计算。

辅助可逆分支：用于处理神经网络加深引起的问题，网络加深将导致信息瓶颈，这将使损失函数无法生成可靠的梯度。

多级辅助信息：用于处理深度监督造成的错误累积问题，特别适用于多个预测分支的架构和轻量级模型。

### 辅助可逆分支

![](https://github.com/Dominic23331/yolov8_tensorrt/assets/53283758/6fb14ec5-e8ed-41bd-9e2f-f0b8152b8606)

可逆分支的问题：

在可逆体系结构中增加主干会消耗大量的推理成本，推理时间将增加20%。

可逆结构在浅层网络上的表现比一般网络差。

解决的方法：

将可逆分支作为深度监管分支的扩展，然后设计辅助可逆分支

优点1： 在一些主要分支中可能因信息瓶颈的bug而丢失重要信息，而本文的方法能够从辅助可逆分支接收驱动参数学习，帮助提取正确的重要信息。

优点2： 不强制主分支保留完整的原始信息，而是通过辅助监督机制生成有用的梯度来更新原始信息。所提的方法也可以应用于较浅的网络。

优点3： 辅助可逆分支可以在推理阶段去除，因此可以保留原始网络的推理能力。

优点4： 可以在PGI中选择任意可逆体系结构来充当辅助可逆分支的角色。

## 多级辅助信息

![](https://github.com/Dominic23331/yolov8_tensorrt/assets/53283758/904d43df-ad8e-438a-9536-7183f684c9bd)

深度监督分支工作原理

目标检测中，可以使用不同的特征金字塔来执行不同的任务，例如它们可以一起检测不同大小的对象。

不足:

会导致深层特征金字塔丢失大量预测目标物体所需的信息

多级辅助信息的概念

在辅助监督的特征金字塔层次和主分支之间插入一个集成网络，然后利用它来组合不同预测头返回的梯度。

多级辅助信息将包含所有目标对象的梯度信息聚合，传递给主分支，再更新参数。

优点:

该方法可以缓解深度监督中的信息破碎问题。

任何集成网络都可以使用多层次的辅助信息。

## GELAN

![](https://github.com/Dominic23331/yolov8_tensorrt/assets/53283758/48af6738-87d6-4efb-9ed0-1578fc698d19)

作者把 CSPNet、 ELAN 这两种神经网络架构结合起来，从而设计出兼顾轻量级、推理速度和准确性的通用高效层聚合网络（generalized efficient layer aggregation network ，GELAN）。

将最初仅使用卷积层堆叠的 ELAN 的功能泛化到可以使用任何计算块的新架构。

## 参考

https://blog.csdn.net/weixin_43334693/article/details/136383022